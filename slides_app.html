<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Slides Web</title>
  <meta name="color-scheme" content="light dark">
  <style>
    :root {
      --bg: #f3f4f6; --panel: #ffffff; --panel-2: #ffffff; --text: #111827;
      --muted: #6b7280; --primary: #1a73e8; --primary-2: #1666cb; --accent: #22d3ee;
      --danger: #ef4444; --border: #e5e7eb; --shadow: 0 10px 24px rgba(0,0,0,.08);
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body { margin: 0; background: var(--bg); color: var(--text);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji"; }
    .app { display: grid; grid-template-rows: 64px 1fr; height: 100vh; }
    .topbar { display: grid; grid-template-columns: 240px 1fr auto; align-items: center; gap: 12px; padding: 10px 16px;
      border-bottom: 1px solid var(--border); background: var(--panel); position: sticky; top: 0; z-index: 5; }
    .brand { display: flex; align-items: center; gap: 10px; font-weight: 800; }
    .brand-badge { width: 28px; height: 28px; border-radius: 6px; background: #fbbc04; position: relative; box-shadow: inset 0 0 0 2px rgba(0,0,0,.04); }
    .brand-badge::after { content:""; position:absolute; inset:6px; background:#fff; border-radius:2px; }
    .doc { display:flex; align-items:center; gap:10px; }
    .doc input { border:none; outline:none; font-weight:700; font-size:14px; background:transparent; color:var(--text); padding:6px 8px; border-radius:6px; }
    .doc input:hover { background:#f3f4f6; }
    .actions { display: flex; align-items: center; gap: 8px; }
    button { background: var(--primary); color: #fff; border: 1px solid #0000; padding: 8px 12px; border-radius: 20px; cursor: pointer; font-weight: 600; }
    button:hover { background: var(--primary-2); }
    .btn-secondary { background: #f3f4f6; border: 1px solid var(--border); color: var(--text); }
    .btn-secondary:hover { background: #e5e7eb; }
    .btn-danger { background: var(--danger); }
    .layout { display: grid; grid-template-columns: 280px 1fr; height: calc(100vh - 64px); }
    .sidebar { border-right: 1px solid var(--border); padding: 12px; overflow: auto; background: #fafafa; }
    .slides-list { display: flex; flex-direction: column; gap: 8px; margin-top: 8px; }
    .slide-item { display: grid; grid-template-columns: 96px 1fr auto; align-items: center; gap: 8px; padding: 8px; border: 1px solid var(--border);
      border-radius: 10px; background: var(--panel); cursor: pointer; box-shadow: var(--shadow); }
    .slide-item.active { outline: 2px solid var(--primary); }
    .thumb { width: 96px; height: 60px; border-radius: 6px; background: #fff; border: 1px solid var(--border); position: relative; overflow: hidden; }
    .thumb .mini { transform: scale(.18); transform-origin: top left; width: 530px; height: 300px; }
    .slide-title { color: var(--text); font-weight: 600; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .slide-meta { color: var(--muted); font-size: 12px; }
    .editor-wrap { padding: 16px; display: grid; grid-template-rows: auto 1fr; gap: 12px; background:#f8fafc; }
    .toolbar { display: flex; flex-wrap: wrap; gap: 8px; background: var(--panel); padding:8px; border:1px solid var(--border); border-radius:12px; position: sticky; top: 8px; z-index:2; }
    .canvas { display: grid; place-items: center; overflow: auto; }
    .slide-canvas { width: min(960px, 90vw); aspect-ratio: 16 / 9; background: #fff; color: #111827; border-radius: 8px; border: 1px solid #e5e7eb;
      box-shadow: var(--shadow); display: grid; grid-template-rows: auto 1fr; padding: 28px; overflow: hidden; }
    .slide-canvas input.title { border: none; border-bottom: 1px dashed #d1d5db; outline: none; font-size: clamp(20px, 4vw, 40px);
      font-weight: 800; margin-bottom: 12px; width: 100%; }
    .slide-canvas .content { outline: none; font-size: clamp(14px, 2.2vw, 22px); line-height: 1.5; overflow: auto; }
    .footer-hint { color: var(--muted); font-size: 12px; text-align: center; padding: 4px 0; }
    @media (max-width: 900px) { .layout { grid-template-columns: 1fr; } .sidebar { order: 2; height: 220px; } .editor-wrap { order: 1; } }
    .btn-mini { padding: 4px 8px; border-radius: 6px; }
  </style>
</head>
<body>
  <div class="app">
    <div class="topbar">
      <div class="brand">
        <div class="brand-badge" aria-hidden="true"></div>
        <div>Slides</div>
      </div>
      <div class="doc">
        <input id="fileName" value="Untitled presentation" aria-label="Document name">
      </div>
      <div class="actions">
        <button id="btn-new">New slide</button>
        <button class="btn-secondary" id="btn-duplicate">Duplicate</button>
        <button class="btn-danger" id="btn-delete">Delete</button>
        <button class="btn-secondary" id="btn-clear" title="Clear all slides">Reset</button>
      </div>
    </div>
    <div class="layout">
      <aside class="sidebar">
        <div style="display:flex;align-items:center;justify-content:space-between;gap:8px;">
          <div style="font-weight:700;">Slides</div>
          <div class="slide-meta" id="count"></div>
        </div>
        <div id="slides" class="slides-list"></div>
        <div class="footer-hint">Tip: Use ↑/↓ to navigate, Cmd/Ctrl+Enter to add</div>
      </aside>
      <main class="editor-wrap">
        <div class="toolbar">
          <button class="btn-secondary" data-cmd="bold" title="Bold">B</button>
          <button class="btn-secondary" data-cmd="italic" title="Italic">I</button>
          <button class="btn-secondary" data-cmd="insertUnorderedList" title="Bulleted list">• List</button>
          <button class="btn-secondary" data-cmd="formatBlock" data-value="h2" title="Heading">H2</button>
          <button class="btn-secondary" data-cmd="formatBlock" data-value="p" title="Paragraph">P</button>
        </div>
        <div class="canvas">
          <div class="slide-canvas">
            <input id="title" class="title" placeholder="Slide title">
            <div id="content" class="content" contenteditable="true" spellcheck="false" placeholder="Start typing..."></div>
          </div>
        </div>
      </main>
    </div>
  </div>

  <script>
    const storageKey = 'slides.web.v2';
    let slides = [];
    let selectedId = null;
    let fileName = 'Untitled presentation';

    const el = (id) => document.getElementById(id);
    const slidesEl = el('slides');
    const titleEl = el('title');
    const contentEl = el('content');
    const countEl = el('count');
    const fileNameEl = el('fileName');

    function uid() { return 's_' + Math.random().toString(36).slice(2, 10); }
    function now() { return Date.now(); }

    function createSlide(partial) {
      return {
        id: uid(),
        title: (partial && partial.title) || 'Untitled',
        html: (partial && partial.html) || '',
        createdAt: now(),
        updatedAt: now(),
      };
    }

    function save() { localStorage.setItem(storageKey, JSON.stringify({ slides, selectedId, fileName })); }
    function load() {
      try {
        const raw = localStorage.getItem(storageKey);
        if (!raw) throw new Error('empty');
        const data = JSON.parse(raw);
        slides = Array.isArray(data.slides) ? data.slides : [];
        selectedId = data.selectedId || (slides[0] && slides[0].id) || null;
        fileName = data.fileName || fileName;
      } catch (e) {
        slides = [createSlide({ title: 'Welcome', html: '<p>Start building your deck.</p>' })];
        selectedId = slides[0].id;
      }
    }

    function selectedIndex() { return slides.findIndex(s => s.id === selectedId); }
    function currentSlide() { return slides.find(s => s.id === selectedId) || null; }

    function addSlide() {
      const idx = selectedIndex();
      const s = createSlide({ title: 'New slide' });
      if (idx >= 0) slides.splice(idx + 1, 0, s); else slides.push(s);
      selectedId = s.id; render(); save(); titleEl.focus(); titleEl.select();
    }
    function duplicateSlide() {
      const cur = currentSlide(); if (!cur) return;
      const s = createSlide({ title: cur.title + ' (copy)', html: cur.html });
      slides.splice(selectedIndex() + 1, 0, s); selectedId = s.id; render(); save();
    }
    function deleteSlide() {
      const idx = selectedIndex(); if (idx < 0) return;
      slides.splice(idx, 1);
      if (!slides.length) { const s = createSlide({ title: 'New slide' }); slides.push(s); selectedId = s.id; }
      else { selectedId = slides[Math.max(0, idx - 1)].id; }
      render(); save();
    }
    function selectSlide(id) { selectedId = id; render(); save(); }

    function updateCurrentFromEditor() {
      const cur = currentSlide(); if (!cur) return;
      cur.title = titleEl.value.trim() || 'Untitled';
      cur.html = contentEl.innerHTML; cur.updatedAt = now();
      const t = document.querySelector(`.slide-item[data-id="${cur.id}"] .slide-title`);
      if (t) t.textContent = cur.title; save();
    }

    function escapeHtml(str) {
      return (str || '')
        .replaceAll('&', '&amp;').replaceAll('<', '&lt;').replaceAll('>', '&gt;')
        .replaceAll('"', '&quot;').replaceAll("'", '&#039;');
    }

    function thumbHTML(slide) {
      const title = (slide.title || '').replaceAll('<','&lt;').replaceAll('>','&gt;');
      return `
        <div class="mini slide-canvas" style="width:530px;height:300px;border-radius:8px;padding:20px;">
          <div style="font-weight:800;font-size:28px;border-bottom:1px dashed #d1d5db;margin-bottom:8px;">${title}</div>
          <div>${slide.html || ''}</div>
        </div>`;
    }

    function renderList() {
      slidesEl.innerHTML = '';
      slides.forEach((s, i) => {
        const item = document.createElement('div');
        item.className = 'slide-item' + (s.id === selectedId ? ' active' : '');
        item.dataset.id = s.id;
        item.innerHTML = `
          <div class="thumb"><div>${thumbHTML(s)}</div></div>
          <div>
            <div class="slide-title">${escapeHtml(s.title)}</div>
            <div class="slide-meta">Slide ${i + 1}</div>
          </div>
          <div style=\"display:flex;gap:6px;\">
            <button class=\"btn-secondary btn-mini\" data-action=\"dup\">⎘</button>
            <button class=\"btn-danger btn-mini\" data-action=\"del\">×</button>
          </div>`;
        item.addEventListener('click', (e) => {
          const btn = e.target.closest('button');
          if (btn && btn.dataset.action === 'dup') { duplicateSlide(); e.stopPropagation(); return; }
          if (btn && btn.dataset.action === 'del') { deleteSlide(); e.stopPropagation(); return; }
          selectSlide(s.id);
        });
        slidesEl.appendChild(item);
      });
      countEl.textContent = slides.length + ' slides';
    }

    function renderEditor() {
      const cur = currentSlide(); if (!cur) return;
      titleEl.value = cur.title; contentEl.innerHTML = cur.html; fileNameEl.value = fileName;
    }
    function render() { renderList(); renderEditor(); }

    // Toolbar commands
    document.querySelectorAll('[data-cmd]').forEach(btn => {
      btn.addEventListener('click', () => {
        const cmd = btn.getAttribute('data-cmd');
        const val = btn.getAttribute('data-value');
        contentEl.focus(); document.execCommand(cmd, false, val); updateCurrentFromEditor();
      });
    });

    // Buttons
    document.getElementById('btn-new').addEventListener('click', addSlide);
    document.getElementById('btn-duplicate').addEventListener('click', duplicateSlide);
    document.getElementById('btn-delete').addEventListener('click', deleteSlide);
    document.getElementById('btn-clear').addEventListener('click', () => {
      if (!confirm('Reset all slides?')) return;
      slides = [createSlide({ title: 'Welcome', html: '<p>Blank deck.</p>' })]; selectedId = slides[0].id; render(); save();
    });

    // Editor listeners
    titleEl.addEventListener('input', updateCurrentFromEditor);
    contentEl.addEventListener('input', updateCurrentFromEditor);
    fileNameEl.addEventListener('input', () => { fileName = fileNameEl.value || 'Untitled presentation'; save(); });

    // Keyboard navigation
    window.addEventListener('keydown', (e) => {
      if (e.key === 'ArrowDown') { const i = Math.min(slides.length - 1, selectedIndex() + 1); selectedId = slides[i].id; render(); e.preventDefault(); }
      else if (e.key === 'ArrowUp') { const i = Math.max(0, selectedIndex() - 1); selectedId = slides[i].id; render(); e.preventDefault(); }
      else if (e.key === 'Enter' && (e.metaKey || e.ctrlKey)) { addSlide(); e.preventDefault(); }
      else if (e.key === 'Backspace' && (e.metaKey || e.ctrlKey)) { deleteSlide(); e.preventDefault(); }
    });

    load();
    render();
  </script>
</body>
</html>


