<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>SlideMaker • Settings</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="./translations.js"></script>
    <style>
      * { box-sizing: border-box; }
      html, body { height: 100%; margin: 0; }
      body {
        font-family: Poppins, sans-serif;
        background: #0b3d2e;
        color: #E8F5E9;
        transition: background-color 0.3s ease;
      }

      /* Header per settings.json */
      header {
        position: sticky; top: 0; z-index: 10;
        background: #0b3d2e;
        border-bottom: 1px solid rgba(255,255,255,0.1);
      }
      .nav { max-width: 1200px; margin: 0 auto; padding: 12px 20px; display: flex; align-items: center; gap: 16px; }
      .logo { font-weight: 700; letter-spacing: .2px; color: white; }
      .menu { display: flex; gap: 12px; }
      .menu a { color: white; font-weight: 600; padding: 8px 10px; border-radius: 8px; transition: opacity .2s; }
      .menu a:hover { opacity: 0.8; }
      .spacer { flex: 1; }

      /* Settings page */
      .container { max-width: 900px; margin: 0 auto; padding: 48px 24px; }
      h1 { font-size: 32px; margin: 0 0 40px; color: #E8F5E9; }
      body.light-mode h1 { color: #0d3b2c; }
      
      .settings-card {
        background: linear-gradient(145deg, rgba(13, 53, 38, 0.9), rgba(9, 34, 24, 0.84));
        border: 1px solid rgba(46, 213, 115, 0.22);
        border-radius: 24px;
        padding: 32px;
        backdrop-filter: blur(24px);
        box-shadow: 0 14px 34px rgba(0, 0, 0, 0.28);
        transition: transform 0.2s ease, box-shadow 0.2s ease;
        display: flex;
        flex-direction: column;
        gap: 24px;
      }

      .settings-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 20px 48px rgba(0, 0, 0, 0.32);
      }

      .settings-card > h2 {
        margin: 0;
        font-size: 22px;
        font-weight: 600;
        color: inherit;
      }

      .form-group {
        margin-bottom: 24px;
      }

      .settings-card > .form-group:last-child {
        margin-bottom: 0;
      }

      .form-label {
        display: block;
        margin-bottom: 12px;
        color: #E8F5E9;
        font-weight: 600;
        font-size: 16px;
      }

      .color-options {
        display: flex;
        flex-direction: column;
        gap: 0;
        border-radius: 12px;
        overflow: hidden;
        background: rgba(255, 255, 255, 0.03);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      .color-option {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 16px 20px;
        cursor: pointer;
        transition: all 0.3s ease;
        background: rgba(255, 255, 255, 0.05);
        backdrop-filter: blur(20px);
        border-bottom: 1px solid rgba(255, 255, 255, 0.08);
        position: relative;
        overflow: hidden;
      }

      .color-option:last-child {
        border-bottom: none;
      }

      .color-option::before {
        content: '';
        position: absolute;
        inset: 0;
        background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%);
        opacity: 0;
        transition: opacity 0.3s ease;
        z-index: 0;
      }

      .color-option:hover::before {
        opacity: 1;
      }

      .color-option:hover {
        background: rgba(255, 255, 255, 0.12);
        transform: translateX(4px);
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      }

      .color-option[data-selected="true"] {
        background: linear-gradient(135deg, rgba(46, 213, 115, 0.3) 0%, rgba(16, 185, 129, 0.2) 100%);
        backdrop-filter: blur(25px);
        border-left: 3px solid #2ed573;
        box-shadow: inset 0 0 20px rgba(46, 213, 115, 0.1);
      }

      .color-option.focused {
        background: linear-gradient(135deg, rgba(59, 130, 246, 0.4) 0%, rgba(37, 99, 235, 0.3) 100%);
        backdrop-filter: blur(25px);
        box-shadow: 0 0 20px rgba(59, 130, 246, 0.3), inset 0 0 20px rgba(59, 130, 246, 0.1);
      }

      .check-icon {
        width: 20px;
        height: 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #2ed573;
        font-weight: 700;
        font-size: 14px;
        position: relative;
        z-index: 1;
      }

      .color-label {
        color: #E8F5E9;
        font-size: 16px;
        font-weight: 500;
        position: relative;
        z-index: 1;
      }

      .color-option.focused .color-label {
        color: #ffffff;
      }

      /* Light mode text colors for better readability */
      body.light-mode .color-label {
        color: #1a1a1a !important;
      }

      body.light-mode .color-option.focused .color-label {
        color: #ffffff !important;
      }

      body.light-mode .color-option[data-selected="true"] .color-label {
        color: #1a1a1a !important;
      }

      body.light-mode .check-icon {
        color: #10b981 !important;
      }

      /* Theme preview overrides */
      #backgroundSelector {
        border-radius: 20px;
        border: none;
        background: transparent;
        padding: 0;
        display: grid;
        gap: 20px;
      }

      @media (min-width: 701px) {
        #backgroundSelector {
          grid-template-columns: repeat(3, minmax(0, 1fr));
        }
      }

      @media (max-width: 700px) {
        #backgroundSelector {
          grid-template-columns: 1fr;
        }
      }

      #backgroundSelector .color-option {
        flex-direction: column;
        align-items: stretch;
        border-left: none;
        border-bottom: none;
        border-radius: 18px;
        padding: 18px 20px 20px;
        background: rgba(255, 255, 255, 0.08);
        border: 1px solid rgba(255, 255, 255, 0.12);
        transform: none;
      }

      #backgroundSelector .color-option::before,
      #backgroundSelector .color-option.focused::before {
        display: none;
      }

      #backgroundSelector .color-option:hover {
        transform: translateY(-4px);
        box-shadow: 0 12px 28px rgba(0, 0, 0, 0.32);
        border-color: rgba(46, 213, 115, 0.35);
      }

      #backgroundSelector .color-option[data-selected="true"] {
        border-color: rgba(46, 213, 115, 0.6);
        box-shadow: 0 18px 36px rgba(0, 0, 0, 0.4);
        background: linear-gradient(145deg, rgba(46, 213, 115, 0.28), rgba(21, 71, 52, 0.4));
      }

      #backgroundSelector .color-option .theme-preview {
        position: relative;
        border-radius: 12px;
        overflow: hidden;
        border: 1px solid rgba(255, 255, 255, 0.18);
        background: rgba(0, 0, 0, 0.2);
        height: 96px;
      }

      #backgroundSelector .color-option .theme-preview img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        display: block;
        filter: saturate(1.05);
      }

      #backgroundSelector .color-option .theme-meta {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 12px;
      }

      #backgroundSelector .color-option .color-label {
        font-size: 16px;
        font-weight: 600;
        color: #E8F5E9;
      }

      #backgroundSelector .color-option .check-icon {
        width: 32px;
        height: 32px;
        border-radius: 50%;
        border: 2px solid rgba(255, 255, 255, 0.35);
        background: rgba(11, 61, 46, 0.45);
        font-size: 18px;
        transition: background 0.2s ease, border-color 0.2s ease, color 0.2s ease;
      }

      #backgroundSelector .color-option[data-selected="true"] .check-icon {
        background: linear-gradient(135deg, #2ed573, #1abc9c);
        border-color: transparent;
        color: #0d3b2c;
      }

      body.light-mode #backgroundSelector .color-option {
        background: rgba(255, 255, 255, 0.9);
        border: 1px solid rgba(0, 0, 0, 0.1);
      }

      body.light-mode #backgroundSelector .color-option[data-selected="true"] {
        background: linear-gradient(145deg, rgba(233, 248, 240, 0.9), rgba(213, 245, 230, 0.9));
        border-color: rgba(26, 156, 109, 0.35);
      }

      body.light-mode #backgroundSelector .color-option .color-label {
        color: #0d3b2c;
      }

      body.light-mode #backgroundSelector .color-option .check-icon {
        background: rgba(255, 255, 255, 0.8);
        border-color: rgba(13, 59, 44, 0.2);
        color: #0d3b2c;
      }

      body.light-mode #backgroundSelector .color-option[data-selected="true"] .check-icon {
        background: linear-gradient(135deg, #2ed573, #1abc9c);
        border-color: transparent;
        color: #ffffff;
      }

      /* App customization */
      .app-customization-section {
        display: flex;
        flex-direction: column;
        gap: 24px;
      }

      .customization-group {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 24px;
        padding: 18px 0;
        border-bottom: 1px solid rgba(255, 255, 255, 0.08);
      }

      .customization-group:last-child {
        border-bottom: none;
      }

      .customization-details {
        display: flex;
        flex-direction: column;
        gap: 6px;
        max-width: 70%;
      }

      .customization-details h3 {
        margin: 0;
        font-size: 18px;
        font-weight: 600;
      }

      .customization-details p {
        margin: 0;
        font-size: 14px;
        line-height: 1.6;
        opacity: 0.85;
      }

      .density-select {
        position: relative;
        display: inline-flex;
        align-items: center;
        gap: 10px;
        padding: 10px 16px;
        border-radius: 12px;
        border: 1px solid rgba(255, 255, 255, 0.25);
        background: rgba(255, 255, 255, 0.08);
        color: #ffffff;
        font-weight: 600;
        cursor: pointer;
        transition: background 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease;
      }

      .density-select span {
        pointer-events: none;
      }

      .density-select::after {
        content: "⌄";
        font-size: 14px;
        opacity: 0.75;
      }

      .density-select select {
        position: absolute;
        inset: 0;
        opacity: 0;
        cursor: pointer;
      }

      .density-select:hover {
        background: rgba(255, 255, 255, 0.15);
        box-shadow: 0 6px 14px rgba(0, 0, 0, 0.2);
        border-color: rgba(255, 255, 255, 0.35);
      }

      body.light-mode .density-select {
        color: #1a1a1a;
        border: 1px solid rgba(0, 0, 0, 0.15);
        background: rgba(0, 0, 0, 0.04);
      }

      body.light-mode .density-select:hover {
        background: rgba(0, 0, 0, 0.08);
      }

      .back-link {
        display: inline-block;
        margin-top: 24px;
        color: #A5D6A7;
        text-decoration: none;
        font-weight: 600;
      }

      .back-link:hover {
        color: #E8F5E9;
      }

      /* Dark metallic gradient background */
      body.dark-theme {
        background: linear-gradient(135deg, #0b0b0b 0%, #0d0d0d 40%, #000000 100%);
        background-attachment: fixed;
        background-repeat: no-repeat;
        background-size: cover;
        color: #eaeaea;
        position: relative;
      }

      body.dark-theme::before {
        content: "";
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: radial-gradient(circle at 30% 20%, rgba(255, 255, 255, 0.05), transparent 60%);
        pointer-events: none;
        z-index: 0;
      }

      body.dark-theme > * {
        position: relative;
        z-index: 1;
      }

      header.dark-theme {
        background: linear-gradient(135deg, #0b0b0b 0%, #0d0d0d 40%, #000000 100%);
        border-bottom: 1px solid rgba(255, 255, 255, 0.05);
      }

      /* Light mode background with frosted glass effect */
      body.light-mode {
        background: linear-gradient(135deg, rgba(255,255,255,0.85), rgba(240,240,240,0.8));
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        color: #1a1a1a;
        transition: all 0.3s ease-in-out;
        position: relative;
      }

      body.light-mode > * {
        position: relative;
        z-index: 1;
      }

      header.light-mode {
        background: rgba(255, 255, 255, 0.4);
        backdrop-filter: blur(15px);
        -webkit-backdrop-filter: blur(15px);
        border-bottom: 1px solid rgba(0, 0, 0, 0.1);
      }

      /* Card or container glass effect */
      body.light-mode .settings-card {
        background: linear-gradient(145deg, rgba(233, 248, 240, 0.95), rgba(203, 240, 223, 0.9));
        border: 1px solid rgba(26, 156, 109, 0.2);
        border-radius: 24px;
        box-shadow: 0 18px 32px rgba(0, 0, 0, 0.12);
        backdrop-filter: blur(24px);
        -webkit-backdrop-filter: blur(24px);
      }

      .about-list {
        list-style: none;
        padding: 0;
        margin: 12px 0 0;
        font-size: 15px;
        line-height: 1.8;
        color: inherit;
      }

      .about-list a {
        color: #2ed573;
        text-decoration: none;
      }

      .about-list a:hover {
        text-decoration: underline;
      }

      /* Profile card */
      .profile-card {
        display: flex;
        align-items: center;
        gap: 24px;
        flex-wrap: wrap;
      }

      .profile-card .profile-avatar {
        width: 72px;
        height: 72px;
        border-radius: 50%;
        overflow: hidden;
        flex-shrink: 0;
        border: 3px solid rgba(255, 255, 255, 0.3);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.25);
      }

      .profile-card .profile-avatar img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        display: block;
      }

      .profile-card .profile-info {
        flex: 1;
        display: flex;
        flex-direction: column;
        gap: 6px;
      }

      .profile-card .profile-name {
        font-size: 20px;
        font-weight: 600;
        color: #FFFFFF;
        margin: 0;
      }

      .profile-card .profile-email {
        font-size: 15px;
        opacity: 0.85;
        color: inherit;
      }

      body.light-mode .profile-card .profile-name {
        color: #0d3b2c;
      }
      .settings-layout {
        display: grid;
        gap: 32px;
      }

      .settings-layout > * {
        width: 100%;
      }

      .settings-row-two {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        width: 100%;
      }

      .settings-row-two > .settings-card {
        height: 100%;
      }

      .settings-row-two .app-customization-section {
        max-width: 100%;
      }

      @media (min-width: 900px) {
        .settings-layout {
          grid-template-columns: repeat(2, minmax(0, 1fr));
        }

        .settings-layout > .profile-card {
          grid-column: span 2;
        }

        .settings-layout > .form-settings-card {
          grid-column: span 2;
        }

        .settings-layout > .settings-row-two {
          grid-column: span 2;
        }

        .settings-layout > #aboutCard {
          grid-column: span 2;
        }
      }

      .profile-card .profile-actions {
        display: flex;
        align-items: center;
      }

      .profile-edit-btn {
        padding: 10px 18px;
        border-radius: 999px;
        border: none;
        background: linear-gradient(135deg, #2ed573, #1abc9c);
        color: #ffffff;
        font-weight: 600;
        letter-spacing: 0.3px;
        cursor: pointer;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
      }

      .profile-edit-btn:hover {
        transform: translateY(-1px);
        box-shadow: 0 8px 16px rgba(46, 213, 115, 0.25);
      }

      .profile-edit-btn:focus {
        outline: 2px solid rgba(46, 213, 115, 0.6);
        outline-offset: 2px;
      }

      .profile-edit-btn:active {
        transform: translateY(0);
      }

      /* Account & Security */
      .security-section {
        display: flex;
        flex-direction: column;
        gap: 24px;
      }

      .security-row {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 24px;
        padding: 18px 0;
        border-bottom: 1px solid rgba(255, 255, 255, 0.08);
      }

      .security-row:last-child {
        border-bottom: none;
      }

      .security-text {
        display: flex;
        flex-direction: column;
        gap: 6px;
        max-width: 70%;
      }

      .security-text h3 {
        margin: 0;
        font-size: 18px;
        font-weight: 600;
      }

      .security-text p {
        margin: 0;
        font-size: 14px;
        line-height: 1.6;
        opacity: 0.85;
      }

      .security-button {
        padding: 10px 20px;
        border-radius: 12px;
        border: 1px solid rgba(255, 255, 255, 0.25);
        background: rgba(255, 255, 255, 0.08);
        color: #ffffff;
        font-weight: 600;
        cursor: pointer;
        transition: transform 0.2s ease, box-shadow 0.2s ease, background 0.2s ease;
      }

      .security-button:hover {
        transform: translateY(-1px);
        background: rgba(255, 255, 255, 0.15);
        box-shadow: 0 6px 14px rgba(0, 0, 0, 0.2);
      }

      .security-button:focus {
        outline: 2px solid rgba(46, 213, 115, 0.6);
        outline-offset: 2px;
      }

      body.light-mode .security-button {
        color: #1a1a1a;
        border: 1px solid rgba(0, 0, 0, 0.15);
        background: rgba(0, 0, 0, 0.04);
      }

      body.light-mode .security-button:hover {
        background: rgba(0, 0, 0, 0.08);
      }

      .security-toggle {
        position: relative;
        width: 56px;
        height: 30px;
      }

      .security-toggle input {
        opacity: 0;
        width: 0;
        height: 0;
      }

      .toggle-slider {
        position: absolute;
        cursor: not-allowed;
        inset: 0;
        background: rgba(255, 255, 255, 0.15);
        border-radius: 999px;
        transition: background 0.2s ease;
      }

      .toggle-slider::before {
        content: "";
        position: absolute;
        height: 24px;
        width: 24px;
        left: 3px;
        top: 3px;
        background: rgba(255, 255, 255, 0.85);
        border-radius: 50%;
        transition: transform 0.2s ease;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      }

      .security-toggle input:checked + .toggle-slider {
        background: linear-gradient(135deg, #2ed573, #1abc9c);
      }

      .security-toggle input:checked + .toggle-slider::before {
        transform: translateX(26px);
      }

      body.light-mode .toggle-slider {
        background: rgba(0, 0, 0, 0.1);
      }

      body.light-mode .toggle-slider::before {
        background: #ffffff;
      }

      /* Preferences */
      .preferences-section {
        display: flex;
        flex-direction: column;
        gap: 24px;
      }

      .preference-row {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 24px;
        padding: 18px 0;
        border-bottom: 1px solid rgba(255, 255, 255, 0.08);
      }

      .preference-row:last-child {
        border-bottom: none;
      }

      .preference-details {
        display: flex;
        flex-direction: column;
        gap: 6px;
        max-width: 70%;
      }

      .preference-details h3 {
        margin: 0;
        font-size: 18px;
        font-weight: 600;
      }

      .preference-details p {
        margin: 0;
        font-size: 14px;
        line-height: 1.6;
        opacity: 0.85;
      }

      .font-size-options {
        display: inline-flex;
        align-items: center;
        background: rgba(255, 255, 255, 0.06);
        border: 1px solid rgba(255, 255, 255, 0.15);
        border-radius: 999px;
        padding: 4px;
        gap: 6px;
      }

      .font-size-button {
        padding: 8px 16px;
        border-radius: 999px;
        border: none;
        background: transparent;
        color: inherit;
        font-weight: 600;
        cursor: pointer;
        transition: background 0.2s ease, color 0.2s ease, transform 0.2s ease;
      }

      .font-size-button.is-active {
        background: linear-gradient(135deg, rgba(46, 213, 115, 0.35), rgba(26, 188, 156, 0.35));
        color: #ffffff;
        transform: translateY(-1px);
      }

      .font-size-button:hover {
        background: rgba(255, 255, 255, 0.12);
      }

      body.light-mode .font-size-options {
        background: rgba(0, 0, 0, 0.05);
        border: 1px solid rgba(0, 0, 0, 0.12);
      }

      body.light-mode .font-size-button {
        color: #1a1a1a;
      }

      body.light-mode .font-size-button.is-active {
        color: #1a1a1a;
        background: rgba(26, 188, 156, 0.24);
      }

      /* Notifications */
      .notifications-section {
        display: flex;
        flex-direction: column;
        gap: 24px;
      }

      .notification-row {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 24px;
        padding: 18px 0;
        border-bottom: 1px solid rgba(255, 255, 255, 0.08);
      }

      .notification-row:last-child {
        border-bottom: none;
      }

      .notification-details {
        display: flex;
        flex-direction: column;
        gap: 6px;
        max-width: 70%;
      }

      .notification-details h3 {
        margin: 0;
        font-size: 18px;
        font-weight: 600;
      }

      .notification-details p {
        margin: 0;
        font-size: 14px;
        line-height: 1.6;
        opacity: 0.85;
      }

      /* Collaboration */
      .collaboration-section {
        display: flex;
        flex-direction: column;
        gap: 24px;
      }

      .collaboration-row {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 24px;
        padding: 18px 0;
        border-bottom: 1px solid rgba(255, 255, 255, 0.08);
      }

      .collaboration-row:last-child {
        border-bottom: none;
      }

      .collaboration-details {
        display: flex;
        flex-direction: column;
        gap: 6px;
        max-width: 70%;
      }

      .collaboration-details h3 {
        margin: 0;
        font-size: 18px;
        font-weight: 600;
      }

      .collaboration-details p {
        margin: 0;
        font-size: 14px;
        line-height: 1.6;
        opacity: 0.85;
      }

      .collaboration-select {
        position: relative;
        display: inline-flex;
        align-items: center;
        gap: 10px;
        padding: 10px 16px;
        border-radius: 12px;
        border: 1px solid rgba(255, 255, 255, 0.25);
        background: rgba(255, 255, 255, 0.08);
        color: #ffffff;
        font-weight: 600;
        cursor: pointer;
        transition: background 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease;
      }

      .collaboration-select span {
        pointer-events: none;
      }

      .collaboration-select::after {
        content: "⌄";
        font-size: 14px;
        opacity: 0.75;
      }

      .collaboration-select:hover {
        background: rgba(255, 255, 255, 0.15);
        box-shadow: 0 6px 14px rgba(0, 0, 0, 0.2);
      }

      body.light-mode .collaboration-select {
        color: #1a1a1a;
        border-color: rgba(0, 0, 0, 0.15);
        background: rgba(0, 0, 0, 0.04);
      }

      body.light-mode .collaboration-select:hover {
        background: rgba(0, 0, 0, 0.08);
      }

      .collaboration-select select {
        position: absolute;
        inset: 0;
        opacity: 0;
        cursor: pointer;
      }

      /* Connected Accounts */
      .connections-section {
        display: flex;
        flex-direction: column;
        gap: 18px;
      }

      .connection-item {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 24px;
        padding: 18px 0;
        border-bottom: 1px solid rgba(255, 255, 255, 0.08);
      }

      .connection-item:last-child {
        border-bottom: none;
      }

      .connection-details {
        display: flex;
        flex-direction: column;
        gap: 4px;
      }

      .connection-details h3 {
        margin: 0;
        font-size: 18px;
        font-weight: 600;
      }

      .connection-details p {
        margin: 0;
        font-size: 14px;
        line-height: 1.6;
        opacity: 0.85;
      }

      .connection-button {
        padding: 10px 20px;
        border-radius: 12px;
        border: 1px solid rgba(255, 255, 255, 0.25);
        background: rgba(255, 255, 255, 0.08);
        color: #ffffff;
        font-weight: 600;
        cursor: pointer;
        transition: transform 0.2s ease, box-shadow 0.2s ease, background 0.2s ease;
      }

      .connection-button:hover {
        transform: translateY(-1px);
        background: rgba(255, 255, 255, 0.15);
        box-shadow: 0 6px 14px rgba(0, 0, 0, 0.2);
      }

      body.light-mode .connection-button {
        color: #1a1a1a;
        border: 1px solid rgba(0, 0, 0, 0.15);
        background: rgba(0, 0, 0, 0.04);
      }

      body.light-mode .connection-button:hover {
        background: rgba(0, 0, 0, 0.08);
      }

      /* Responsive layout tweaks */
      @media (max-width: 900px) {
        .settings-layout {
          grid-template-columns: 1fr;
        }

        .profile-card {
          align-items: flex-start;
        }
        
        .settings-row-two {
          grid-template-columns: 1fr;
        }
      }

      @media (max-width: 768px) {
        .profile-card {
          flex-direction: column;
          text-align: center;
        }

        .profile-card .profile-info,
        .profile-card .profile-actions {
          width: 100%;
          align-items: center;
        }

        .profile-card .profile-actions {
          justify-content: center;
        }

        .security-row,
        .preference-row,
        .notification-row,
        .collaboration-row,
        .connection-item,
        .customization-group {
          flex-direction: column;
          align-items: flex-start;
          width: 100%;
        }

        .security-text,
        .preference-details,
        .notification-details,
        .collaboration-details,
        .connection-details {
          max-width: 100%;
        }

        .security-button,
        .delete-button,
        .collaboration-select,
        .connection-button,
        .font-size-options,
        .density-select {
          width: 100%;
          justify-content: center;
        }

        .font-size-options {
          justify-content: space-between;
        }

        .font-size-button {
          flex: 1;
        }

        .security-toggle {
          align-self: flex-start;
        }
      }

      .delete-button {
        padding: 10px 22px;
        border-radius: 12px;
        border: 1px solid rgba(220, 53, 69, 0.5);
        background: rgba(220, 53, 69, 0.12);
        color: #ff6b6b;
        font-weight: 600;
        cursor: pointer;
        transition: transform 0.2s ease, box-shadow 0.2s ease, background 0.2s ease;
      }

      .delete-button:hover {
        transform: translateY(-1px);
        background: rgba(220, 53, 69, 0.18);
        box-shadow: 0 6px 14px rgba(220, 53, 69, 0.25);
      }

      .delete-button:focus {
        outline: 2px solid rgba(220, 53, 69, 0.5);
        outline-offset: 2px;
      }

      body.light-mode .delete-button {
        color: #c0392b;
        background: rgba(192, 57, 43, 0.08);
        border: 1px solid rgba(192, 57, 43, 0.4);
      }

      body.light-mode .delete-button:hover {
        background: rgba(192, 57, 43, 0.14);
      }

      /* Modals */
      .modal-overlay {
        position: fixed;
        inset: 0;
        background: rgba(5, 15, 10, 0.72);
        backdrop-filter: blur(16px);
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 24px;
      }

      .modal-overlay.is-visible {
        opacity: 1;
        pointer-events: auto;
      }

      .modal-card {
        width: min(420px, 90vw);
        border-radius: 20px;
        padding: 28px 32px;
        background: linear-gradient(145deg, rgba(18, 53, 38, 0.95), rgba(8, 25, 18, 0.92));
        border: 1px solid rgba(255, 255, 255, 0.08);
        box-shadow: 0 20px 45px rgba(0, 0, 0, 0.35);
        display: flex;
        flex-direction: column;
        gap: 20px;
        position: relative;
      }

      body.light-mode .modal-card {
        background: rgba(255, 255, 255, 0.92);
        border: 1px solid rgba(0, 0, 0, 0.08);
        box-shadow: 0 20px 45px rgba(0, 0, 0, 0.15);
      }

      .modal-card h3 {
        margin: 0;
        font-size: 22px;
        font-weight: 600;
      }

      .modal-card p {
        margin: 0;
        font-size: 14px;
        line-height: 1.7;
        opacity: 0.88;
      }

      .modal-actions {
        display: flex;
        justify-content: flex-end;
        gap: 12px;
      }

      .modal-close,
      .modal-confirm {
        padding: 10px 18px;
        border-radius: 10px;
        border: none;
        font-weight: 600;
        cursor: pointer;
        transition: transform 0.2s ease, box-shadow 0.2s ease, background 0.2s ease;
      }

      .modal-close {
        background: rgba(255, 255, 255, 0.08);
        color: #ffffff;
      }

      .modal-close:hover {
        background: rgba(255, 255, 255, 0.15);
        transform: translateY(-1px);
      }

      .modal-confirm {
        background: linear-gradient(135deg, #ff5f6d, #ffc371);
        color: #ffffff;
      }

      .modal-confirm:hover {
        transform: translateY(-1px);
        box-shadow: 0 8px 18px rgba(255, 95, 109, 0.35);
      }

      body.light-mode .modal-close {
        background: rgba(0, 0, 0, 0.05);
        color: #1a1a1a;
      }

      body.light-mode .modal-close:hover {
        background: rgba(0, 0, 0, 0.08);
      }

      /* Navigation colors */
      .nav a, .nav span, .logo {
        color: inherit;
        transition: color 0.3s ease;
      }

      body.light-mode .nav a,
      body.light-mode .nav span,
      body.light-mode .logo {
        color: #222;
      }

      body.dark-theme .nav a,
      body.dark-theme .nav span,
      body.dark-theme .logo {
        color: #eaeaea;
      }

      /* Headings */
      body.light-mode h1, 
      body.light-mode h2, 
      body.light-mode h3 {
        color: #1a1a1a !important;
      }

      body.dark-theme h1, 
      body.dark-theme h2, 
      body.dark-theme h3 {
        color: #f5f5f5;
      }

      /* Form labels and inputs in light mode */
      body.light-mode .form-label {
        color: #1a1a1a !important;
      }

      body.light-mode .form-select {
        background: rgba(255, 255, 255, 0.6);
        border-color: rgba(0, 0, 0, 0.15);
        color: #1a1a1a;
      }

      body.light-mode .back-link {
        color: #1a1a1a !important;
      }

      /* Color options in light mode */
      body.light-mode .color-option {
        background: rgba(255, 255, 255, 0.5);
        border-bottom: 1px solid rgba(0, 0, 0, 0.1);
      }

      body.light-mode .color-option:hover {
        background: rgba(255, 255, 255, 0.7);
      }

      body.light-mode .color-option[data-selected="true"] {
        background: linear-gradient(135deg, rgba(16, 185, 129, 0.3) 0%, rgba(46, 213, 115, 0.2) 100%);
        border-left: 3px solid #10b981;
      }

      body.light-mode .color-option.focused {
        background: linear-gradient(135deg, rgba(59, 130, 246, 0.4) 0%, rgba(37, 99, 235, 0.3) 100%);
      }

      body.light-mode .color-options {
        background: rgba(255, 255, 255, 0.3);
        border: 1px solid rgba(0, 0, 0, 0.1);
      }
    </style>
  </head>
  <body>
    <header>
      <div class="nav">
        <div class="logo" data-translate="common.slideMaker">SlideMaker</div>
        <nav class="menu" aria-label="Main">
          <a href="./Home.html" data-translate="common.home">Home</a>
          <a href="#" class="active" data-translate="common.settings">Settings</a>
        </nav>
        <div class="spacer"></div>
      </div>
    </header>

    <main class="container">
      <h1 data-translate="settings.title">Settings</h1>
      
      <div class="settings-layout">
        <section class="settings-card profile-card" aria-labelledby="profileHeading">
        <div class="profile-avatar" aria-hidden="true">
          <img src="https://i.pravatar.cc/120?img=12" alt="Sample profile avatar">
        </div>
        <div class="profile-info">
          <h2 id="profileHeading" class="profile-name">Avery Johnson</h2>
          <span class="profile-email">avery.johnson@example.com</span>
        </div>
        <div class="profile-actions">
          <a href="./edit_profile.html" class="profile-edit-btn">Edit Profile</a>
        </div>
        </section>

      <section class="settings-card security-section" aria-labelledby="securityHeading">
        <h2 id="securityHeading">Account &amp; Security</h2>

        <div class="security-row">
          <div class="security-text">
            <h3>Change Password</h3>
            <p>Update your password regularly to keep your account protected. Add logic to open the modal when ready.</p>
          </div>
          <button type="button" class="security-button" aria-haspopup="dialog" aria-controls="changePasswordModal">Change Password</button>
        </div>

        <div class="security-row">
          <div class="security-text">
            <h3>Two-Factor Authentication</h3>
            <p>Add an extra layer of security to your account. Toggle will activate once logic is connected.</p>
          </div>
          <label class="security-toggle">
            <input type="checkbox" disabled aria-disabled="true">
            <span class="toggle-slider"></span>
          </label>
        </div>

        <div class="security-row">
          <div class="security-text">
            <h3>Delete Account</h3>
            <p>Permanently remove your account and associated data. Connect a confirmation flow before enabling.</p>
          </div>
          <button type="button" class="delete-button" aria-haspopup="dialog" aria-controls="deleteAccountModal">Delete Account</button>
        </div>
      </section>

      <section class="settings-card preferences-section" aria-labelledby="preferencesHeading">
        <h2 id="preferencesHeading">Preferences</h2>

        <div class="preference-row">
          <div class="preference-details">
            <h3>Auto-Save Presentations</h3>
            <p>Automatically back up your presentation progress while you work. Toggle logic coming soon.</p>
          </div>
          <label class="security-toggle">
            <input type="checkbox" disabled aria-disabled="true">
            <span class="toggle-slider"></span>
          </label>
        </div>

        <div class="preference-row">
          <div class="preference-details">
            <h3>Font Size</h3>
            <p>Adjust the interface typography that suits your presentation workflow best.</p>
          </div>
          <div class="font-size-options" role="group" aria-label="Font size selection">
            <button type="button" class="font-size-button is-active" aria-pressed="true">Normal</button>
            <button type="button" class="font-size-button" aria-pressed="false">Large</button>
          </div>
        </div>

        <div class="preference-row">
          <div class="preference-details">
            <h3>Enable Animations</h3>
            <p>Control interface motion for transitions and micro-interactions. Toggle functionality is pending.</p>
          </div>
          <label class="security-toggle">
            <input type="checkbox" disabled aria-disabled="true">
            <span class="toggle-slider"></span>
          </label>
        </div>
      </section>

      <section class="settings-card notifications-section" aria-labelledby="notificationsHeading">
        <h2 id="notificationsHeading">Notifications</h2>

        <div class="notification-row">
          <div class="notification-details">
            <h3>Project Activity</h3>
            <p>Stay updated when changes happen across your shared presentations. Logic will be linked soon.</p>
          </div>
          <label class="security-toggle">
            <input type="checkbox" disabled aria-disabled="true">
            <span class="toggle-slider"></span>
          </label>
        </div>

        <div class="notification-row">
          <div class="notification-details">
            <h3>Comments &amp; Mentions</h3>
            <p>Get notified when teammates leave feedback or mention you. Hook into your notifications service when ready.</p>
          </div>
          <label class="security-toggle">
            <input type="checkbox" disabled aria-disabled="true">
            <span class="toggle-slider"></span>
          </label>
        </div>

        <div class="notification-row">
          <div class="notification-details">
            <h3>Group Invites</h3>
            <p>Receive alerts for collaboration invites and shared workspace access. Toggle activation pending.</p>
          </div>
          <label class="security-toggle">
            <input type="checkbox" disabled aria-disabled="true">
            <span class="toggle-slider"></span>
          </label>
        </div>

        <div class="notification-row">
          <div class="notification-details">
            <h3>Email Updates</h3>
            <p>Enable digest summaries and important app announcements. Connect to your email settings later.</p>
          </div>
          <label class="security-toggle">
            <input type="checkbox" disabled aria-disabled="true">
            <span class="toggle-slider"></span>
          </label>
        </div>
      </section>

      <section class="settings-card collaboration-section" aria-labelledby="collaborationHeading">
        <h2 id="collaborationHeading">Collaboration Settings</h2>

        <div class="collaboration-row">
          <div class="collaboration-details">
            <h3>Default Sharing</h3>
            <p>Choose how new presentations are shared by default. Hook this select to your sharing preferences when ready.</p>
          </div>
          <div class="collaboration-select">
            <span>Private</span>
            <select aria-label="Default sharing preference" disabled>
              <option selected>Private</option>
              <option>Team Only</option>
              <option>Public</option>
            </select>
          </div>
        </div>

        <div class="collaboration-row">
          <div class="collaboration-details">
            <h3>Show Active Collaborators</h3>
            <p>Display avatars for teammates currently editing the same presentation. Toggle activation coming soon.</p>
          </div>
          <label class="security-toggle">
            <input type="checkbox" disabled aria-disabled="true">
            <span class="toggle-slider"></span>
          </label>
        </div>
      </section>

      <div class="settings-row-two">
        <section class="settings-card connections-section" aria-labelledby="connectionsHeading">
          <h2 id="connectionsHeading">Connected Accounts</h2>

          <div class="connection-item">
            <div class="connection-details">
              <h3>Connect Google Drive</h3>
              <p>Link your Google Drive to import slides and sync assets. Integration coming soon.</p>
            </div>
            <button type="button" class="connection-button">Connect</button>
          </div>

          <div class="connection-item">
            <div class="connection-details">
              <h3>Connect GitHub</h3>
              <p>Sync project assets or store presentations in repositories. Hook this button to OAuth flow later.</p>
            </div>
            <button type="button" class="connection-button">Connect</button>
          </div>

          <div class="connection-item">
            <div class="connection-details">
              <h3>Connect Dropbox</h3>
              <p>Enable Dropbox backups and quick access to shared folders. Placeholder for upcoming integration.</p>
            </div>
            <button type="button" class="connection-button">Connect</button>
          </div>
        </section>

        <section class="settings-card app-customization-section" aria-labelledby="customizationHeading">
          <h2 id="customizationHeading">App Customization</h2>

          <div class="customization-group">
            <div class="customization-details">
              <h3>Rounded Corners</h3>
              <p>Choose whether interface surfaces use softened, rounded corners across the app.</p>
            </div>
            <label class="security-toggle">
              <input type="checkbox" checked disabled aria-disabled="true">
              <span class="toggle-slider"></span>
            </label>
          </div>

          <div class="customization-group">
            <div class="customization-details">
              <h3>Glass Effect</h3>
              <p>Preview a frosted glass aesthetic for cards and surfaces. Toggle coming soon.</p>
            </div>
            <label class="security-toggle">
              <input type="checkbox" disabled aria-disabled="true">
              <span class="toggle-slider"></span>
            </label>
          </div>

          <div class="customization-group">
            <div class="customization-details">
              <h3>UI Density</h3>
              <p>Adjust spacing for controls and content layouts to match your working style.</p>
            </div>
            <div class="density-select">
              <span>Comfortable</span>
              <select aria-label="UI density selection" disabled>
                <option selected>Comfortable</option>
                <option>Compact</option>
              </select>
            </div>
          </div>
        </section>
      </div>

        <div class="settings-card form-settings-card">
        <div class="form-group">
          <label class="form-label" for="backgroundSelector" data-translate="settings.backgroundColor">Background Color</label>
          <div class="color-options" id="backgroundSelector">
            <div class="color-option" data-color="#ffffff">
                <div class="theme-preview">
                <img src="./CURSOR-Project/thems-mods/light.jpeg" alt="light">
                </div>
                <div class="theme-meta">
              <span class="color-label" data-translate="settings.light">Light</span>
                  <span class="check-icon"></span>
                </div>
            </div>
            <div class="color-option" data-color="#000000">
                <div class="theme-preview">
                <img src="./CURSOR-Project/thems-mods/dark.jpeg" alt="dark">
                </div>
                <div class="theme-meta">
              <span class="color-label" data-translate="settings.dark">Dark</span>
                  <span class="check-icon"></span>
                </div>
              </div>
              <div class="color-option" data-color="#0b3d2e" data-selected="true">
                <div class="theme-preview">
                <img src="./CURSOR-Project/thems-mods/defult.jpeg" alt="defult">
                </div>
                <div class="theme-meta">
                  <span class="color-label">System Default</span>
                  <span class="check-icon">✓</span>
                </div>
            </div>
          </div>
        </div>

        <div class="form-group">
          <label class="form-label" for="languageSelector" data-translate="settings.language">Language</label>
          <div class="color-options" id="languageSelector">
            <div class="color-option" data-lang="en" data-selected="true">
              <span class="check-icon">✓</span>
              <span class="color-label" data-translate="settings.english">English</span>
            </div>
            <div class="color-option" data-lang="ar">
              <span class="check-icon"></span>
              <span class="color-label" data-translate="settings.arabic">Arabic</span>
            </div>
          </div>
        </div>
      </div>

      <div class="settings-card" id="aboutCard">
        <div class="form-group">
          <label class="form-label" data-translate="settings.aboutTitle">About App</label>
          <ul class="about-list">
            <li>
              <span data-translate="settings.version">Version</span>:
              <strong id="appVersion">1.0.0</strong>
            </li>
            <li>
              <span data-translate="settings.developer">Developed by</span>:
              <strong id="devName">Mohammed Al-Otaibi</strong>
            </li>
            <li>
              <span data-translate="settings.contact">Contact</span>:
              <a id="contactEmail" href="mailto:your-email@example.com">your-email@example.com</a>
            </li>
            <li>
              <a href="#" id="privacyPolicyLink" data-translate="settings.privacyPolicy">Privacy Policy</a>
            </li>
          </ul>
          </div>
        </div>

      </div>

      <div class="modal-overlay" id="changePasswordModal" role="dialog" aria-modal="true" aria-labelledby="changePasswordHeading" aria-hidden="true">
        <div class="modal-card">
          <h3 id="changePasswordHeading">Change Password</h3>
          <p>This is a placeholder for the upcoming password reset flow. Hook up your logic and form here.</p>
          <div class="modal-actions">
            <button type="button" class="modal-close">Cancel</button>
            <button type="button" class="modal-confirm">Save New Password</button>
          </div>
        </div>
      </div>

      <div class="modal-overlay" id="deleteAccountModal" role="dialog" aria-modal="true" aria-labelledby="deleteAccountHeading" aria-hidden="true">
        <div class="modal-card">
          <h3 id="deleteAccountHeading">Delete Account</h3>
          <p>This popup confirms your decision before removing your account. Connect functionality to handle the process.</p>
          <div class="modal-actions">
            <button type="button" class="modal-close">Cancel</button>
            <button type="button" class="modal-confirm">Yes, Delete</button>
          </div>
        </div>
      </div>
 
      <a href="./Home.html" class="back-link" data-translate="settings.backToHome">← Back to Home</a>
    </main>

    <script>
      // Route Protection - Check authentication on page load
      (function() {
        const currentUser = JSON.parse(localStorage.getItem('currentUser') || 'null');
        const isGuest = localStorage.getItem('guest') === 'true';
        
        // If not authenticated and not a guest, redirect to welcome page
        if (!currentUser && !isGuest) {
          window.location.href = './index.html';
          return;
        }
      })();
      
      // Load saved background color from localStorage
      const savedBg = localStorage.getItem('siteBackgroundColor') || '#0b3d2e';
      if (savedBg === '#000000') {
        document.body.classList.add('dark-theme');
        document.body.style.background = '';
        document.body.style.color = '';
        document.querySelector('header').classList.add('dark-theme');
        document.querySelector('header').style.background = '';
      } else if (savedBg === '#ffffff') {
        document.body.classList.add('light-mode');
        document.body.style.background = '';
        document.body.style.color = '';
        document.querySelector('header').classList.add('light-mode');
        document.querySelector('header').style.background = '';
      } else {
        document.body.style.background = savedBg;
        document.querySelector('header').style.background = savedBg;
      }
      
      // Set selected option based on saved value
      const options = document.querySelectorAll('.color-option');
      options.forEach(option => {
        option.removeAttribute('data-selected');
        option.classList.remove('focused');
        const checkIcon = option.querySelector('.check-icon');
        if (option.getAttribute('data-color') === savedBg) {
          option.setAttribute('data-selected', 'true');
          checkIcon.textContent = '✓';
        } else {
          checkIcon.textContent = '';
        }
      });

      // Update background color when option is clicked
      options.forEach(option => {
        option.addEventListener('click', () => {
          const color = option.getAttribute('data-color');
          
          // Update all options
          options.forEach(opt => {
            opt.removeAttribute('data-selected');
            opt.classList.remove('focused');
            const icon = opt.querySelector('.check-icon');
            if (opt === option) {
              opt.setAttribute('data-selected', 'true');
              icon.textContent = '✓';
            } else {
              icon.textContent = '';
            }
          });
          
          // Update body background
          document.body.classList.remove('dark-theme', 'light-mode');
          document.querySelector('header').classList.remove('dark-theme', 'light-mode');
          
          if (color === '#000000') {
            document.body.classList.add('dark-theme');
            document.body.style.background = '';
            document.body.style.color = '';
            document.querySelector('header').classList.add('dark-theme');
            document.querySelector('header').style.background = '';
          } else if (color === '#ffffff') {
            document.body.classList.add('light-mode');
            document.body.style.background = '';
            document.body.style.color = '';
            document.querySelector('header').classList.add('light-mode');
            document.querySelector('header').style.background = '';
          } else {
            document.body.style.background = color;
            document.querySelector('header').style.background = color;
            document.querySelector('.logo').style.color = 'white';
            document.querySelectorAll('.menu a').forEach(a => a.style.color = 'white');
          }
          
          // Save to localStorage
          localStorage.setItem('siteBackgroundColor', color);
          
          // Also update Home.html if it's open
          if (window.opener) {
            window.opener.postMessage({ type: 'updateBackground', color: color }, '*');
          }
        });

        // Add focus effect on hover
        option.addEventListener('mouseenter', () => {
          if (!option.hasAttribute('data-selected')) {
            option.classList.add('focused');
          }
        });

        option.addEventListener('mouseleave', () => {
          option.classList.remove('focused');
        });

        // Keyboard navigation
        option.addEventListener('keydown', (e) => {
          if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            option.click();
          }
        });

        option.setAttribute('tabindex', '0');
      });

      // Listen for messages from other windows
      window.addEventListener('message', (e) => {
        if (e.data.type === 'updateBackground') {
          const color = e.data.color;
          
          document.body.classList.remove('dark-theme', 'light-mode');
          document.querySelector('header').classList.remove('dark-theme', 'light-mode');
          
          if (color === '#000000') {
            document.body.classList.add('dark-theme');
            document.body.style.background = '';
            document.body.style.color = '';
            document.querySelector('header').classList.add('dark-theme');
            document.querySelector('header').style.background = '';
          } else if (color === '#ffffff') {
            document.body.classList.add('light-mode');
            document.body.style.background = '';
            document.body.style.color = '';
            document.querySelector('header').classList.add('light-mode');
            document.querySelector('header').style.background = '';
          } else {
            document.body.style.background = color;
            document.querySelector('header').style.background = color;
          }
          
          // Update selected option
          options.forEach(option => {
            option.removeAttribute('data-selected');
            option.classList.remove('focused');
            const checkIcon = option.querySelector('.check-icon');
            if (option.getAttribute('data-color') === color) {
              option.setAttribute('data-selected', 'true');
              checkIcon.textContent = '✓';
            } else {
              checkIcon.textContent = '';
            }
          });
        }
        if (e.data.type === 'updateLanguage') {
          const lang = e.data.language;
          localStorage.setItem('siteLanguage', lang);
          applyTranslations(lang);
        }
      });

      // About card dynamic fields
      const ABOUT_APP_VERSION = '1.0.0';
      const ABOUT_DEV_NAMES = ['Mohammed Al-Otaibi', 'Ahmed Al-Asmari', 'Ali Al-Khathami'];
      const ABOUT_CONTACT_EMAIL = 'Mohammedfake56@gmail.com';

      const versionEl = document.getElementById('appVersion');
      const devNameEl = document.getElementById('devName');
      const contactEl = document.getElementById('contactEmail');
      const privacyLinkEl = document.getElementById('privacyPolicyLink');

      if (versionEl) versionEl.textContent = ABOUT_APP_VERSION;
      if (devNameEl) devNameEl.innerHTML = ABOUT_DEV_NAMES.join('<br>');
      if (contactEl) {
        contactEl.textContent = ABOUT_CONTACT_EMAIL;
        contactEl.href = 'mailto:' + ABOUT_CONTACT_EMAIL;
      }

      if (privacyLinkEl) {
        privacyLinkEl.addEventListener('click', (event) => {
          event.preventDefault();
          const lang = localStorage.getItem('siteLanguage') || document.documentElement.lang || 'en';
          const dict = (window.translations && window.translations[lang]) || window.translations.en;
          const message = (dict && dict['common.privacyComingSoon']) || 'Privacy policy coming soon.';
          alert(message);
        });
      }

      if (typeof window.applyTranslations === 'function') {
        window.applyTranslations(localStorage.getItem('siteLanguage') || document.documentElement.lang || 'en');
      }

      // Make translations available globally
      window.translations = translations;
      
      // Load saved language
      const savedLang = localStorage.getItem('siteLanguage') || 'en';
      applyTranslations(savedLang);

      // Language selector functionality
      const langOptions = document.querySelectorAll('#languageSelector .color-option');
      langOptions.forEach(option => {
        option.removeAttribute('data-selected');
        option.classList.remove('focused');
        const checkIcon = option.querySelector('.check-icon');
        if (option.getAttribute('data-lang') === savedLang) {
          option.setAttribute('data-selected', 'true');
          checkIcon.textContent = '✓';
        } else {
          checkIcon.textContent = '';
        }
      });

      langOptions.forEach(option => {
        option.addEventListener('click', () => {
          const lang = option.getAttribute('data-lang');
          
          // Update all options
          langOptions.forEach(opt => {
            opt.removeAttribute('data-selected');
            opt.classList.remove('focused');
            const icon = opt.querySelector('.check-icon');
            if (opt === option) {
              opt.setAttribute('data-selected', 'true');
              icon.textContent = '✓';
            } else {
              icon.textContent = '';
            }
          });
          
          // Save to localStorage
          localStorage.setItem('siteLanguage', lang);
          
          // Apply translations
          applyTranslations(lang);
          
          // Notify other windows
          if (window.opener) {
            window.opener.postMessage({ type: 'updateLanguage', language: lang }, '*');
          }
          
          // Broadcast to all windows
          window.postMessage({ type: 'updateLanguage', language: lang }, '*');
        });

        // Add focus effect on hover
        option.addEventListener('mouseenter', () => {
          if (!option.hasAttribute('data-selected')) {
            option.classList.add('focused');
          }
        });

        option.addEventListener('mouseleave', () => {
          option.classList.remove('focused');
        });

        // Keyboard navigation
        option.addEventListener('keydown', (e) => {
          if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            option.click();
          }
        });

        option.setAttribute('tabindex', '0');
      });
    </script>
  </body>
  </html>

